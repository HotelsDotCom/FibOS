/*! uiSpriter - v1.0.4 - 2015-03-18 */
var uiSpriter=function(){var a=function(a){function b(a,b){this.$el=null,this._ID=a,this._selectorsMapping=null,this._globalSelectors=null,this._styles={},this._options={extension:{},reference:"body"},this._init(b)}return b.prototype={initOptions:function(){},initStyles:function(){},initEvents:function(){},createSubElements:function(){},afterInit:function(){},appendTo:function(b){b&&(b instanceof String&&(b=a(b)),this.$el.appendTo(b))},show:function(){this.$el.show()},hide:function(){this.$el.hide()},setOptions:function(){for(var a in arguments)arguments.hasOwnProperty(a)&&this._extendObject(this._options,arguments[a])},setStyles:function(){for(var a in arguments)arguments.hasOwnProperty(a)&&this._extendObject(this._styles,arguments[a])},_init:function(a){this.initOptions(a),this.initStyles(this._options.extension),this._createElement(),this._createStyleTag(),this.initEvents(),this.afterInit()},_createElement:function(){var b=a("#"+this._ID);b.length>0&&(b.remove(),console.log("Container ID already in use and thus has been removed.")),this.$el=a("<div/>").attr("id",this._ID),this.createSubElements()},_createStyleTag:function(){var b=this._ID+"-style";a("#"+b).remove();var c,d,e,f,g,h=a("<style/>").attr("id",b);for(e in this._styles)this._styles.hasOwnProperty(e)&&(f=this._styles[e],d=this._selectorsMapping&&this._selectorsMapping[e],g=this._globalSelectors&&this._globalSelectors[e],c=g?"":"#"+this._ID,"main"!=e&&(c+=" "+(d||"."+e)),h.append(c+" {"+this._styleObjectToString(f)+"}"));a("head").append(h)},_extendObject:function(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]&&a[c]instanceof Object&&!(a[c]instanceof Array)?this._extendObject(a[c],b[c]):a[c]=b[c])},_styleObjectToString:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c+":"+a[c]+";");return b.join("")}},b}(jQuery),b=function(a,b){function c(c,d){this._spritesInfo={},this._spritesTotal=0,this._spritesLoaded=0,b.call(this,c,d),s.call(this),a(window).off(".uiSpriter").on("resize.uiSpriter",s.bind(this))}function d(){return"hidden"===this.$el.css("visibility")?!1:(this._options.visible||j(this.$el),!0)}function e(a){return(a?this._spritesLoaded:++this._spritesLoaded)<this._spritesTotal?!1:(this._options.visible||k(this.$el),this._options.callback&&this._options.callback(this._spritesInfo),!0)}function f(b,c){var d=a(this._options.reference),e=d.find("*");return console.log("calculating... (please, wait until done!)"),e.each(function(b,c){var d=a(c),e=d.css("background-image"),f=""===this._options.domain;if(!f&&e.indexOf(this._options.domain)>-1&&(f=!0),f&&"url"!==e.substr(0,3)&&(f=!1),f&&-1===e.indexOf("http")&&(f=!1),f){var h=g(d),i=p(d.css("padding-left"))+p(d.css("padding-right")),j=p(d.css("padding-top"))+p(d.css("padding-bottom")),k={l:h.x,t:h.y},l={w:i+d.width(),h:j+d.height()};e&&"none"!==e&&(this._spritesInfo[e]||(this._spritesInfo[e]=[]),this._spritesInfo[e].push({pos:k,size:l}))}}.bind(this)),console.log("DONE!"),this._spritesTotal=o.call(this),b?(b(this._spritesInfo,c),!0):this._spritesInfo}function g(a){var b=a.css("background-image"),c=h(b),d=a.width(),e=a.height(),f=a.css("background-position").split(" "),g=f[0],i=f[1];return g="left"==g||"0%"==g?0:"center"==g||"50%"==g?-(c.width-d)/2:"right"==g||"100%"==g?-(c.width-d):parseInt(g),i="top"==i||"0%"==i?0:"center"==i||"50%"==i?-(c.height-e)/2:"bottom"==i||"100%"==i?-(c.height-e):parseInt(i),{x:-g,y:-i}}function h(b){var c=b.replace(/url\((['"])?(.*?)\1\)/gi,"$2").split(",")[0],d=a("<img/>").attr("src",c);return{width:d.prop("width"),height:d.prop("height")}}function i(b){var c,d,e,f;for(var g in b)if(b.hasOwnProperty(g)){f=this.filenameFromCss(g,!0).replace(/[.]/g,"_"),d=n(b[g]),e=a("<div/>").attr("id",f).addClass("obscurers_container"),c=l.call(this,g,e),e.append(c);for(var h in d)d.hasOwnProperty(h)&&e.append(d[h]);this.$el.append(e)}}function j(a){a.css("visibility","hidden").show()}function k(a){a.css("visibility","visible").hide()}function l(b,c){d.call(this);var f=h(b);return c.css(f),this._options.visible||k(c),e.call(this),a("<img/>").attr("src",q(b))}function m(b){var c="top:"+b.pos.t+"px; left:"+b.pos.l+"px; width:"+b.size.w+"px; height:"+b.size.h+"px;";return a("<div/>").addClass("sprite_obscurer").attr("style",c)}function n(a){var b,c,d=[];for(var e in a)a.hasOwnProperty(e)&&(b=a[e],c=m(b),d.push(c));return d}function o(){var a,b=0;for(a in this._spritesInfo)this._spritesInfo.hasOwnProperty(a)&&b++;return b}function p(a){return Number(a.replace(/px|%/g,""))}function q(a){return a.replace(/url\(|\"|\)/g,"")}function r(a){var b=a.lastIndexOf("/");return a.substr(b+1)}function s(){this.$el.width(a(window).width()).height(a(window).height())}return c.prototype=Object.create(b.prototype),c.prototype.initOptions=function(a){this.setOptions({visible:!0,opacity:"0.3",color:"#f00",border:"#0f0",image:"",domain:"",callback:null},a)},c.prototype.initStyles=function(a){var b=this._options.image&&""!==this._options.image?'url("'+this._options.image+'")':"none";this.setStyles({main:{position:"relative",display:this._options.visible?"block":"none"},obscurers_container:{position:"relative",display:"block",background:b,top:"0",left:"0","text-align":"left",border:"1px solid "+this._options.border,visibility:this._options.visible?"visible":"hidden"},sprite_obscurer:{position:"absolute",display:"block",background:this._options.color,opacity:this._options.opacity}},a)},c.prototype.filenameFromCss=function(a,b){var c=r(q(a));return b?c.replace(/.png|.jpg|.jpeg|.gif/g,""):c},c.prototype.analyze=function(){f.call(this,i.bind(this))},c.prototype.toggleSprite=function(b){var c,d,e=a("#fibo_sprites_bg");this.$el.hide(),e.show(),a(".obscurers_container").hide(),"hide_sprites"!==b&&(c=b.replace("toggle_sprite_",""),c=c.replace(/[.]/g,"_"),d=a(".obscurers_container#"+c),d.show(),this.$el.show())},c.prototype.logSpritesList=function(){var b=[];this.$el.find(".obscurers_container").each(function(c,d){b.push(a(d).attr("id"))}),console.log(b)},c}(jQuery,a);return b}();