/*! uiMarker - v1.1.3 - 2015-03-10 */
var uiMarker=function(){var a=function(a){function b(a,b){this.$el=null,this._ID=a,this._selectorsMapping=null,this._globalSelectors=null,this._styles={},this._options={extension:{},reference:"body"},this.init(b)}return b.prototype={initOptions:function(a){a&&this.extendObject(this._options,a)},initStyles:function(a){a&&this.extendObject(this._styles,a)},initEvents:function(){},createSubElements:function(){},afterInit:function(){},init:function(a){this.initOptions(a),this.initStyles(this._options.extension),this.createElement(),this.createStyleTag(),this.initEvents(),this.afterInit()},createElement:function(){var b=a("#"+this._ID);b.length>0&&(b.remove(),console.log("Container ID already in use and thus has been removed.")),this.$el=a("<div/>").attr("id",this._ID),this.createSubElements()},createStyleTag:function(){var b=this._ID+"-style";a("#"+b).remove();var c,d,e,f,g,h=a("<style/>").attr("id",b);for(e in this._styles)this._styles.hasOwnProperty(e)&&(f=this._styles[e],d=this._selectorsMapping&&this._selectorsMapping[e],g=this._globalSelectors&&this._globalSelectors[e],c=g?"":"#"+this._ID,"main"!=e&&(c+=" "+(d||"."+e)),h.append(c+" {"+this.styleObjectToString(f)+"}"));a("head").append(h)},show:function(){this.$el.show()},hide:function(){this.$el.hide()},extendObject:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]&&a[c]instanceof Object&&!(a[c]instanceof Array)?this.extendObject(a[c],b[c]):a[c]=b[c])},styleObjectToString:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c+":"+a[c]+";");return b.join("")}},b}(jQuery),b=function(a,b){function c(a,c){b.call(this,a,c)}function d(b,c){var d=this._options.markerData;if(a(b).data(d)===!0)return!0;c||(c=m(b));var e=a('<div class="'+this._options.markerClass+'"/>').width(c.width).height(c.height).offset(c.offset).click(function(b){g.call(this,a(b.currentTarget),d)}.bind(this));f.call(this,b,e,d)}function e(b,c){var d=this._options.fontData;if(a(b).data(d)===!0)return!0;c||(c=m(b));var e=l(b),h=a('<p class="fi1"/>').text(e[0]),i=a('<p class="fi2"/>').text(e[1]),j=a('<p class="fi3"/>').text(e[2]),k=a('<div class="'+this._options.fontClass+'"/>').append(h,i,j).offset({top:c.offset.top-45,left:c.offset.left+10}).click(function(b){g.call(this,a(b.currentTarget),d)}.bind(this));f.call(this,b,k,d)}function f(b,c,d){a(b).data(d,!0),a(c).data("ref",b),this.$el.append(c)}function g(b,c){a(a(b).data("ref")).data(c,!1),a(b).remove()}function h(){var b=q(this._options.taglist);a(b).off(".prevent").on("click.prevent",function(c){a(c.target).is(b)&&0===a(c.target).closest(this._options.excluded).length&&c.preventDefault()}.bind(this))}function i(){var b=q(this._options.taglist);a(b).off(".prevent")}function j(a){r.call(this,a.target)&&this.addTextFontHighlight(a.target)}function k(b){a(b.currentTarget).remove()}function l(b){var c=a(b),d=c.css("font-weight"),e=c.css("font-size").replace("px",""),f=c.css("font-family").split(",")[0].replace(/\"|'/g,""),g=f.split(" ")[0].substr(0,1).toUpperCase(),h=f.split(" ")[1]?f.split(" ")[1].substr(0,1).toUpperCase():f.substr(1,1).toLowerCase(),i=g+h;return[i,d,e]}function m(b){var c=n(b),d=a(b);return{width:d.width(),height:d.height()-(c.t+c.b),offset:{left:d.offset().left+parseInt(d.css("padding-left")),top:d.offset().top+parseInt(d.css("padding-top"))+c.t}}}function n(b){var c=a(b),d=!0,e=c.css("font-weight"),f=c.css("font-size").replace("px",""),g=c.css("font-family").split(",")[0].replace(/\"|\'| /g,"").toLowerCase(),h={arial:p(),"open sans":p()};if(h.arial[8]=o(0,0),h.arial[12]=o(3,1),h.arial[18]=o(2,-1),h.arial[20]=o(6,3),h["open sans"][12]=o(1,-1),h["open sans"][21]=o(5,1),h["open sans"][26]=o(11,5),d){var i=[];i.push('family:"'+g+'" - size:'+f+" - weight:"+e),h[g]||i.push("fontFAMILY not used.. we'll implement it soon!"),h[g]&&(!h[g][f]||0===h[g][f].t&&0===h[g][f].b)&&i.push("fontSIZE not used.. we'll implement it soon!"),i.push("-----------------"),console.log(i.join("\n"))}var j;return j=h[g]?h[g]:p(),j=j[f]?j[f]:j[8]}function o(a,b){return{t:a&&0!==a?a:0,b:b&&0!==b?b:0}}function p(){return{8:o(),9:o(),10:o(),11:o(),12:o(),13:o(),14:o(),15:o(),16:o(),17:o(),18:o(),19:o(),20:o(),21:o(),22:o(),23:o(),24:o(),25:o(),26:o(),27:o(),28:o(),29:o()}}function q(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&a[c]&&b.push(c);return b.join(",")}function r(b){var c=a(b);if(""!==this._options.excluded&&c.closest(this._options.excluded).length>0)return!1;var d=""!==c.html()&&""!==c.text()&&" "!==c.text()&&"&nbsp;"!==c.text();if(d){var e,f=this._options.taglist;for(e in f)if(f.hasOwnProperty(e)&&f[e]&&c.is(e))return!0;if(c.is("div")&&0===c.find("*").length)return!0}return!1}return c.prototype=Object.create(b.prototype),c.prototype.initOptions=function(a){this.extendObject(this._options,{checkUseMarker:null,checkUseFont:null,markerClass:"fiboMarker",fontClass:"fiboFontinfo",markerData:"markerHL",fontData:"markerFI",excluded:"",taglist:{p:!0,span:!0,strong:!0,li:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,a:!0,input:!0,select:!0,textfield:!0,label:!0}}),b.prototype.initOptions.call(this,a),this.extendObject(this._options,{excluded:(""===this._options.excluded?"":this._options.excluded+",")+"."+this._options.fontClass})},c.prototype.initStyles=function(a){var c=this._options.markerClass,d=this._options.fontClass;this._selectorsMapping={marker:"."+c,fontinfo:"."+d,fontinfo_p:"."+d+" p",fontinfo_p1:"."+d+" p.fi1",fontinfo_p2:"."+d+" p.fi2",fontinfo_p3:"."+d+" p.fi3"},this.extendObject(this._styles,{main:{position:"absolute"},marker:{position:"absolute !important","z-index":"1",background:"#0ff",opacity:"0.5"},fontinfo:{position:"absolute !important","z-index":"2",background:"rgba(34, 34, 34, 0.7)",border:"1px solid #fff",padding:"3px","font-family":"Open Sans",color:"#fff"},fontinfo_p:{margin:"0",cursor:"default","text-algin":"center"},fontinfo_p1:{"font-size":"13px","font-weight":"700","margin-top":"-4px"},fontinfo_p2:{"font-size":"10px","font-weight":"400",margin:"-5px 0"},fontinfo_p3:{"font-size":"14px","font-weight":"600","margin-bottom":"-4px"}}),b.prototype.initStyles.call(this,a)},c.prototype.initEvents=function(){var b=this._options.reference,c="."+this._options.markerClass,d=q(this._options.taglist);a(b).off(".markerevent").on("click.markerevent",j.bind(this)).on("click.markerevent",c,k.bind(this)),a(d).data(this._options.markerData,null),a(d).data(this._options.fontData,null)},c.prototype.toggleListener=function(a){a?h.call(this):i.call(this)},c.prototype.addTextFontHighlight=function(a){var b,c=this._options.checkUseMarker?this._options.checkUseMarker():!0,f=this._options.checkUseFont?this._options.checkUseFont():!0;return c||f?(b=m(a),c&&d.call(this,a,b),f&&e.call(this,a,b),!0):!1},c}(jQuery,a);return b}();