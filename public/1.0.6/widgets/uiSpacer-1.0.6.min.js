/*! uiSpacer - v1.0.6 - 2015-03-29 */
var uiSpacer=function(){var a=function(a){function b(a,b){this.$el=null,this._ID=a,this._selectorsMapping=null,this._globalSelectors=null,this._styles={},this._options={extension:{},reference:"body"},this._init(b)}return b.prototype={initOptions:function(){},initStyles:function(){},initEvents:function(){},createSubElements:function(){},afterInit:function(){},appendTo:function(b){b&&(b instanceof String&&(b=a(b)),this.$el.appendTo(b))},show:function(){this.$el.show()},hide:function(){this.$el.hide()},setOptions:function(){for(var a in arguments)arguments.hasOwnProperty(a)&&this._extendObject(this._options,arguments[a])},setStyles:function(){for(var a in arguments)arguments.hasOwnProperty(a)&&this._extendObject(this._styles,arguments[a])},_init:function(a){this.initOptions(a),this.initStyles(this._options.extension),this._createElement(),this._createStyleTag(),this.initEvents(),this.afterInit()},_createElement:function(){var b=a("#"+this._ID);b.length>0&&(b.remove(),console.log("Container ID already in use and thus has been removed.")),this.$el=a("<div/>").attr("id",this._ID),this.createSubElements()},_createStyleTag:function(){var b=this._ID+"-style";a("#"+b).remove();var c,d,e,f,g,h=a("<style/>").attr("id",b);for(e in this._styles)this._styles.hasOwnProperty(e)&&(f=this._styles[e],d=this._selectorsMapping&&this._selectorsMapping[e],g=this._globalSelectors&&this._globalSelectors[e],c=g?"":"#"+this._ID,"main"!=e&&(c+=" "+(d||"."+e)),h.append(c+" {"+this._styleObjectToString(f)+"}"));a("head").append(h)},_extendObject:function(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]&&a[c]instanceof Object&&!(a[c]instanceof Array)?this._extendObject(a[c],b[c]):a[c]=b[c])},_styleObjectToString:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c+":"+a[c]+";");return b.join("")}},b}(jQuery),b=function(a,b){function c(a,c){this._defaultGroupName="spacerGroup_",this._lastUsedGroup=this._defaultGroupName+"1",this._mousezero=null,this._dragging=null,this._dragged=null,this.spacersGroups=null,this.spacerObjects=null,b.call(this,a,c)}function d(a,b,c){return g.call(this,a,b,c)}function e(b){return b&&this.spacersGroups[b]?(a("#"+b).remove(),delete this.spacersGroups[b],!0):!1}function f(){return this.$el.empty(),this.spacersGroups={},!0}function g(b,c,d){b||(b=this._lastUsedGroup);var e=a("#"+b);return 0===e.length&&(e=a("<div/>").attr("id",b).addClass("spacers_group"),c||this.$el.append(e),!d&&this._options.groupCallback&&this._options.groupCallback(b)),this._lastUsedGroup=b,e}function h(){var b,c={};this.$el.find("."+this._options.spacerClass).each(function(d,e){var f=a(e);b=f.parent().attr("id"),b===this._ID&&(b="spacerGroupDefault"),c[b]||(c[b]=[]),c[b].push([parseInt(this.getSpacerType.call(this,e)),Number(f.css("top").replace("px","")),Number(f.css("left").replace("px",""))])}.bind(this)),this.spacersGroups=c}function i(){return h.call(this),JSON.stringify(this.spacersGroups)}function j(a,b,c){var d,e=JSON.parse(a);for(var f in e)e.hasOwnProperty(f)&&(b?(delete this.spacersGroups[f],d=e[f]):(d=this.spacersGroups[f],d||(d=[]),d.push.apply(d,e[f])),this.spacersGroups[f]=d);return k.call(this,c)}function k(b){var c,e,f,g,h,i=[];for(var j in this.spacersGroups)if(this.spacersGroups.hasOwnProperty(j)){g=[],e=this.spacersGroups[j],a("#"+j).remove();for(var k=0;k<e.length;k++)c="f_"+("000"+e[k][0]).substr(-3),f=this.spacerObjects[c].clone(),f.css("top",e[k][1]),f.css("left",e[k][2]),g.push(f.prop("outerHTML"));this._options.grouping?(h=d.call(this,j,!0,!0),h.html(g.join("")),b&&h.hide(),i.push(h.prop("outerHTML"))):i.push(g.join(""))}return i.join("")}function l(a,b,c){var d=j.call(this,a,b,c);this.$el.html(d)}function m(){var a,b,c,d,e="65",f=this._options.spacerMin-1,g=A.call(this,f),h=[],i=this._options.spacerColors,j=this._options.spacerSymbols,k=i.length,l=j.length,m=f,n=0;m>=k&&(m-=Math.floor(m/k)*k),h.after={position:"absolute",left:"0",color:"#fff","-khtml-opacity":"."+e,"-moz-opacity":"."+e,"-ms-filter":'"alpha(opacity='+e+')"',filter:"alpha(opacity="+e+")",opacity:"."+e};for(var o in g)g.hasOwnProperty(o)&&(b=g[o],a=z.call(this,b),c=("000"+b).substr(-3),d=this._options.spacerClass+".fs_"+c,h[d]={width:g[o]+"px",height:g[o]+"px",background:i[m]},this._globalSelectors[d]=!0,a>=k&&(h[d+":after"]={content:'"'+j[n].s+'"',"font-size":Number(b*j[n].f)+"px","line-height":Number(b*j[n].l)+"px"},this._globalSelectors[d+":after"]=!0,(a+1)%k===0&&++n>=l&&(n=l-1)),++m>=k&&(m=0));return h}function n(a){var b=Math.round(a%1*100)/100,c=.25>b?0:b>.75?1:.5;return Math.floor(a)+c}function o(a){var b={top:n(Number(a.css("top").replace("px",""))),left:n(Number(a.css("left").replace("px","")))};a.css(b)}function p(){var a=0;for(var b in this.spacersGroups)this.spacersGroups.hasOwnProperty(b)&&a++;return a}function q(a){var b=a.shiftKey?10:a.altKey?.5:1;return this._dragged&&a.keyCode>=37&&a.keyCode<=40?(this._dragged.offset({top:this._dragged.offset().top+(38===a.keyCode?-b:40===a.keyCode?b:0),left:this._dragged.offset().left+(37===a.keyCode?-b:39===a.keyCode?b:0)}),this._options.moveCallback&&this._options.moveCallback(this._dragged),!1):!0}function r(a){switch(a.type){case"mousedown":t.call(this,a);case"mousemove":v.call(this,a);break;case"mouseup":w.call(this,a)}}function s(){this.$el.css(B.call(this))}function t(b){var c=a(b.target);return this._mousezero={top:c.position().top-b.pageY+B.call(this).top,left:c.position().left-b.pageX+B.call(this).left},u.call(this,c),!1}function u(a){a.parent().append(a),this.updateGroups(),this._dragged=null,this._dragging=a}function v(a){return this._dragging?(this._dragging.offset({top:Number(a.pageY+this._mousezero.top),left:Number(a.pageX+this._mousezero.left)}),o(this._dragging),!1):!0}function w(){return this._dragged=this._dragging,this._dragged?(this._dragged.focus(),void(this._dragging&&(this._dragging=null,this.updateGroups(),this._options.moveCallback&&this._options.moveCallback(this._dragged)))):!0}function x(){for(var b,c={},d=this._options.spacerMin-1;d<this._options.spacersList.length;d++)b=("00"+this._options.spacersList[d]).substr(-3),c["f_"+b]=a("<div/>").addClass(this._options.spacerClass+" fs_"+b).attr("tabindex","");return c}function y(a,b){for(var c=1,d=1,e=0,f=[],g=1;b>=g;g++)c+=e,e=d,d=c,f.push(c);return 0>=a&&(a=1),f.splice(a-1,b-a+1)}function z(a){var b=this._options.spacersList;for(var c in b)if(b.hasOwnProperty(c)&&b[c]===a)return Number(c);return-1}function A(a,b){(!a||0>a)&&(a=0),(!b||b>this._options.spacersList.length-1)&&(b=this._options.spacersList.length-1);for(var c=[],d=a;b>=d;d++)c.push(this._options.spacersList[d]);return c}function B(){return a(this._options.reference).offset()}return c.prototype=Object.create(b.prototype),c.prototype.initOptions=function(a){this.setOptions({localStorage:"fibonacciGroups",spacerClass:"fibospacer",spacerMatch:/fibospacer|fs|_| /g,grouping:!0,moveCallback:null,groupCallback:null,spacersList:y(1,12),spacerMin:3,spacerSymbols:[{s:"•",f:2.8,l:1},{s:"★",f:1,l:1.09}],spacerColors:["#0071bc","#ed1e79","#8cc63f","#fbb03b"]},a)},c.prototype.initStyles=function(a){var b="0 0 5px 2px #222222 inset";this._selectorsMapping={spacer:"."+this._options.spacerClass,shadow:"."+this._options.spacerClass+":focus",after:"."+this._options.spacerClass+":after"},this._globalSelectors={spacer:!0,shadow:!0,after:!0},this.setStyles({main:{position:"absolute",top:B.call(this).top+"px",left:B.call(this).left+"px",width:"0",height:"0",overflow:"visible"},spacer:{position:"absolute",display:"block",cursor:"pointer",overflow:"hidden","font-family":"Arial",outline:"0"},shadow:{"-webkit-box-shadow":b,"-moz-box-shadow":b,"box-shadow":b}},m.call(this),a)},c.prototype.initEvents=function(){this.$el.off(".spacerevent").on("mousedown.spacerevent","."+this._options.spacerClass,r.bind(this)),a("body").off(".spacerevent").on("mousemove.spacerevent",r.bind(this)).on("mouseup.spacerevent",r.bind(this)).on("keydown.spacerevent",q.bind(this)),a(window).off(".spacerevent").on("scroll.spacerevent resize.spacerevent",s.bind(this))},c.prototype.afterInit=function(){this.spacersGroups={},this.spacerObjects=x.call(this)},c.prototype.addNewSpacer=function(a,b){if(-1==z.call(this,a))return console.log("WARNING: addSpacer called with unsupported spacer"),null;b||(b=this._lastUsedGroup);var c=("000"+a).substr(-3),e=this.spacerObjects["f_"+c].clone(),f=this._options.grouping?d.call(this,b):this.$el;return e&&f.append(e),e},c.prototype.dragSpacer=function(a){u.call(this,a)},c.prototype.getSpacerType=function(b){return a(b).attr("class").replace(this._options.spacerMatch,"")},c.prototype.getSpacersList=function(a){return A.call(this,a?this._options.spacerMin-1:0)},c.prototype.renameGroup=function(b,c){if(!b||!c)return!1;if(b===c)return!1;if(a("#"+c).length>0)return!1;var f=this.spacersGroups[b];if(!f)return!1;this.spacersGroups[c]=f;var g=d.call(this,c);return g.html(a("#"+b).html()),e.call(this,b),!0},c.prototype.offsetCustomGroup=function(b,c){for(var d=0;d<b.length;d++){var e=a(b[d]),f=e.offset(),g={left:f.left+Number(c.left),top:f.top+Number(c.top)};e.offset(g)}},c.prototype.offsetGroup=function(b){var c,d,e=this.spacersGroups[this._lastUsedGroup],f=a("#"+this._lastUsedGroup).find("."+this._options.spacerClass);e&&f.each(function(f,g){var h=a(g);c=Number(e[f][1]),d=Number(e[f][2]),h.css("top",c+Number(b.top)),h.css("left",d+Number(b.left))})},c.prototype.saveOffsetGroup=function(a){var b,c=this.spacersGroups[this._lastUsedGroup];if(c){for(b in c)c.hasOwnProperty(b)&&(c[b][1]=Number(c[b][1])+Number(a.top),c[b][2]=Number(c[b][2])+Number(a.left));this.spacersGroups[this._lastUsedGroup]=c}},c.prototype.selectGroup=function(a){this._lastUsedGroup=a?a:this._defaultGroupName+(p.call(this)+1)},c.prototype.updateGroups=function(){h.call(this)},c.prototype.spacersGroupLength=function(b){return a("#"+(b||this._lastUsedGroup)).find("div").length},c.prototype.setLocalStorage=function(){return localStorage.setItem(this._options.localStorage,i.call(this)),!0},c.prototype.getLocalStorage=function(a){f.call(this);var b=localStorage.getItem(this._options.localStorage);return b&&l.call(this,b,!0,a),b},c.prototype.loadSpacersFromJson=function(a,b){return a&&l.call(this,a,!0,b),a},c.prototype.getFibonacci=function(a,b){y(a,b)},c.prototype.setMouseZero=function(a){!a.top&&0!==a.top||!a.left&&0!==a.left?console.log("WARNING: setMouseZero called with wrong parameter"):this._mousezero=a},c}(jQuery,a);return b}();