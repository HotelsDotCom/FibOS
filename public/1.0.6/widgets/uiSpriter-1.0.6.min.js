/*! uiSpriter - v1.0.6 - 2015-03-10 */
var uiSpriter=function(){var a=function(a){function b(a,b){this.$el=null,this._ID=a,this._selectorsMapping=null,this._globalSelectors=null,this._styles={},this._options={extension:{},reference:"body"},this.init(b)}return b.prototype={initOptions:function(a){a&&this.extendObject(this._options,a)},initStyles:function(a){a&&this.extendObject(this._styles,a)},initEvents:function(){},createSubElements:function(){},afterInit:function(){},init:function(a){this.initOptions(a),this.initStyles(this._options.extension),this.createElement(),this.createStyleTag(),this.initEvents(),this.afterInit()},createElement:function(){var b=a("#"+this._ID);b.length>0&&(b.remove(),console.log("Container ID already in use and thus has been removed.")),this.$el=a("<div/>").attr("id",this._ID),this.createSubElements()},createStyleTag:function(){var b=this._ID+"-style";a("#"+b).remove();var c,d,e,f,g,h=a("<style/>").attr("id",b);for(e in this._styles)this._styles.hasOwnProperty(e)&&(f=this._styles[e],d=this._selectorsMapping&&this._selectorsMapping[e],g=this._globalSelectors&&this._globalSelectors[e],c=g?"":"#"+this._ID,"main"!=e&&(c+=" "+(d||"."+e)),h.append(c+" {"+this.styleObjectToString(f)+"}"));a("head").append(h)},show:function(){this.$el.show()},hide:function(){this.$el.hide()},extendObject:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]&&a[c]instanceof Object&&!(a[c]instanceof Array)?this.extendObject(a[c],b[c]):a[c]=b[c])},styleObjectToString:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c+":"+a[c]+";");return b.join("")}},b}(jQuery),b=function(a,b){function c(c,d){this.spritesInfo={},this.spritesLoaded=0,this.spritesTotal=0,b.call(this,c,d),u.call(this),a(window).off(".uiSpriter").on("resize.uiSpriter",u.bind(this))}function d(){return"hidden"===this.$el.css("visibility")?!1:(this._options.visible||i(this.$el),!0)}function e(a){return(a?this.spritesLoaded:++this.spritesLoaded)<this.spritesTotal?!1:(this._options.visible||j(this.$el),this._options.callback&&this._options.callback(this.spritesInfo),!0)}function f(a){var b=t(a);delete this.spritesInfo[b],this.spritesTotal=p.call(this),e.call(this,!0)}function g(b,c){var d=a(this._options.reference),e=d.find("*");return console.log("calculating... (please, wait until done!)"),e.each(function(b,c){var d=a(c),e=d.css("background-image"),f=""===this._options.domain;if(!f&&e.indexOf(this._options.domain)>-1&&(f=!0),f&&"url"!==e.substr(0,3)&&(f=!1),f&&-1===e.indexOf("http")&&(f=!1),f){var g=d.css("background-position"),h=g.split(" "),i=-1*q(h[0]),j=-1*q(h[1]),k=q(d.css("padding-left"))+q(d.css("padding-right")),l=q(d.css("padding-top"))+q(d.css("padding-bottom")),m={l:i,t:j},n={w:k+d.width(),h:l+d.height()};e&&"none"!==e&&(this.spritesInfo[e]||(this.spritesInfo[e]=[]),this.spritesInfo[e].push({pos:m,size:n}))}}.bind(this)),console.log("DONE!"),this.spritesTotal=p.call(this),b?(b(this.spritesInfo,c),!0):this.spritesInfo}function h(b){var c,d,e,f;for(var g in b)if(b.hasOwnProperty(g)){f=this.filenameFromCss(g,!0),d=o(b[g]),c=k.call(this,g),e=a('<div id="'+f+'" class="obscurers_container"/>'),e.append(c);for(var h in d)d.hasOwnProperty(h)&&e.append(d[h]);this.$el.append(e)}}function i(a){a.css("visibility","hidden").show()}function j(a){a.css("visibility","visible").hide()}function k(b){var c=r(b),e=this.filenameFromCss(b,!0);d.call(this);var f=a("<img/>");return f.on("load",l.bind(this,e)).on("error",m.bind(this)),f.attr("src",c),f}function l(b,c){var d=a("#"+b),f=a(c.target),g={width:f.width(),height:f.height()};d.css(g),this._options.visible||j(d),e.call(this)}function m(a){var b=a.target.src;alert("Failed to load the image:\n"+b),f.call(this,b)}function n(b){var c="top:"+b.pos.t+"px; left:"+b.pos.l+"px; width:"+b.size.w+"px; height:"+b.size.h+"px;";return a("<div/>").addClass("sprite_obscurer").attr("style",c)}function o(a){var b,c,d=[];for(var e in a)a.hasOwnProperty(e)&&(b=a[e],c=n(b),d.push(c));return d}function p(){var a,b=0;for(a in this.spritesInfo)this.spritesInfo.hasOwnProperty(a)&&b++;return b}function q(a){return Number(a.replace(/px|%/g,""))}function r(a){return a.replace(/url\(|\"|\)/g,"")}function s(a){var b=a.lastIndexOf("/");return a.substr(b+1)}function t(a){return'url("'+a+'")'}function u(){this.$el.width(a(window).width()).height(a(window).height())}return c.prototype=Object.create(b.prototype),c.prototype.initOptions=function(a){this.extendObject(this._options,{visible:!0,opacity:"0.3",color:"#f00",border:"#0f0",image:"",domain:"",callback:null}),b.prototype.initOptions.call(this,a)},c.prototype.initStyles=function(a){this.extendObject(this._styles,{main:{position:"relative",display:this._options.visible?"block":"none"},obscurers_container:{position:"relative",display:"block",top:"0",left:"0","text-align":"left",border:"1px solid "+this._options.border,visibility:"hidden"},sprite_obscurer:{position:"absolute",display:"block",background:this._options.color,opacity:this._options.opacity}}),this._options.image&&""!==this._options.image&&(this._styles.obscurers_container.background='url("'+this._options.image+'") repeat scroll 0 0 transparent'),b.prototype.initStyles.call(this,a)},c.prototype.filenameFromCss=function(a,b){var c=s(r(a));return b?c.replace(/.png|.jpg|.jpeg|.gif/g,""):c},c.prototype.analyze=function(){g.call(this,h.bind(this))},c.prototype.toggleSprite=function(b){var c,d,e=a("#"+this._ID),f=a("#fibo_sprites_bg");e.hide(),f.show(),a(".obscurers_container").hide(),"hide_sprites"!==b&&(c=b.replace("toggle_sprite_",""),d=a(".obscurers_container#"+c),d.show(),e.show())},c}(jQuery,a);return b}();