/*! uiRuler - v1.0.6 - 2015-03-29 */
var uiRuler=function(){var a=function(a){function b(a,b){this.$el=null,this._ID=a,this._selectorsMapping=null,this._globalSelectors=null,this._styles={},this._options={extension:{},reference:"body"},this._init(b)}return b.prototype={initOptions:function(){},initStyles:function(){},initEvents:function(){},createSubElements:function(){},afterInit:function(){},appendTo:function(b){b&&(b instanceof String&&(b=a(b)),this.$el.appendTo(b))},show:function(){this.$el.show()},hide:function(){this.$el.hide()},setOptions:function(){for(var a in arguments)arguments.hasOwnProperty(a)&&this._extendObject(this._options,arguments[a])},setStyles:function(){for(var a in arguments)arguments.hasOwnProperty(a)&&this._extendObject(this._styles,arguments[a])},_init:function(a){this.initOptions(a),this.initStyles(this._options.extension),this._createElement(),this._createStyleTag(),this.initEvents(),this.afterInit()},_createElement:function(){var b=a("#"+this._ID);b.length>0&&(b.remove(),console.log("Container ID already in use and thus has been removed.")),this.$el=a("<div/>").attr("id",this._ID),this.createSubElements()},_createStyleTag:function(){var b=this._ID+"-style";a("#"+b).remove();var c,d,e,f,g,h=a("<style/>").attr("id",b);for(e in this._styles)this._styles.hasOwnProperty(e)&&(f=this._styles[e],d=this._selectorsMapping&&this._selectorsMapping[e],g=this._globalSelectors&&this._globalSelectors[e],c=g?"":"#"+this._ID,"main"!=e&&(c+=" "+(d||"."+e)),h.append(c+" {"+this._styleObjectToString(f)+"}"));a("head").append(h)},_extendObject:function(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]&&a[c]instanceof Object&&!(a[c]instanceof Array)?this._extendObject(a[c],b[c]):a[c]=b[c])},_styleObjectToString:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c+":"+a[c]+";");return b.join("")}},b}(jQuery),b=function(a,b){function c(a,c){b.call(this,a,c)}function d(){var b,c,d,e,f=this.ruler.clone().addClass("ruler_min"),g=this.ruler.clone().addClass("ruler_med"),h=this.ruler.clone().addClass("ruler_max"),i=Math.floor(this._options.rulerMed/this._options.rulerMin),j=Math.floor(this._options.rulerMax/this._options.rulerMed),k=Math.ceil(o.call(this)/this._options.rulerMax),l=Math.ceil(n.call(this)/this._options.rulerMax);for(b=0;i>b;b++)g.append(f.clone().css(p(b*this._options.rulerMin)));for(c=0;j>c;c++)h.append(g.clone().css(p(c*this._options.rulerMed)));if(this._options.showRulerH){for(d=0;l>d;d++)this.rulers_h.append(h.clone().css(p(d*this._options.rulerMax)).append(this.ruler_lab.clone().text((d+1)*this._options.rulerMax)));this.$el.append(this.rulers_h)}if(this._options.showRulerV){for(e=0;k>e;e++)this.rulers_v.append(h.clone().css(p(e*this._options.rulerMax)).append(this.ruler_lab.clone().text((e+1)*this._options.rulerMax)));this.$el.append(this.rulers_v)}this._options.showMousePos&&0===a("#").length&&this.$el.append(this.mousepos),this.$el.append(this.rulertop),this.$el.append(this.guides)}function e(a){if(this._options.showMousePos){var b=l.call(this,a.pageX,a.pageY),c="x:"+b.relative.left+", y:"+b.relative.top;this.mousepos.offset(b.absolute),this.mousepos.text(c)}if(this.guide_dragging){var d,e=q(this.guide_dragging),f=m.call(this),g=k.call(this,a);return"v"===e&&(d={top:f.top,left:g.coords.x}),"h"===e&&(d={left:f.left,top:g.coords.y}),this.guide_dragging.offset(d),!1}return!0}function f(b){var c=r(b.currentTarget),d=this.guideline.clone().addClass("guide_"+c),f=a(this._options.guidelinesContainer);return f.append(d),this.guide_dragging=d,this.guide_dragged=null,e.call(this,b),!1}function g(b){return this.guide_dragging=a(b.currentTarget),this.guide_dragged=null,e.call(this,b),!1}function h(b){var c=k.call(this,b),d=a(b.target).closest(".rulers_container").length>0,e=b.pageX>c.bounds.x.min&&b.pageX<c.bounds.x.max&&b.pageY>c.bounds.y.min&&b.pageY<c.bounds.y.max;!this.guide_dragging||!d&&e||(this.guide_dragging.remove(),this.guide_dragging=null),this.guide_dragged=this.guide_dragging,this.guide_dragging=null}function i(a){var b=a.shiftKey?10:a.altKey?.5:1;if(this.guide_dragged&&a.keyCode>=37&&a.keyCode<=40){var c={top:this.guide_dragged.position().top+(38===a.keyCode?-b:40===a.keyCode?b:0),left:this.guide_dragged.position().left+(37===a.keyCode?-b:39===a.keyCode?b:0)};return"v"===q(this.guide_dragged)&&this.guide_dragged.css({left:c.left}),"h"===q(this.guide_dragged)&&this.guide_dragged.css({top:c.top}),!1}return!0}function j(){var b=m.call(this).top-a(window).scrollTop()-this._options.rulerWidth,c=m.call(this).left-a(window).scrollLeft()-this._options.rulerWidth;this.$el.css({top:m.call(this).top,left:m.call(this).left});var d=0>=b?{position:"fixed",top:"0",left:m.call(this).left}:{position:"absolute",top:-this._options.rulerWidth,left:0},e=0>=c?{left:-m.call(this).left+a(window).scrollLeft()}:{left:-this._options.rulerWidth};this.rulers_h.css(d),this.rulers_v.css(e);var f={top:d.top,position:d.position};f.left=0>=b?this.rulers_v.offset().left:e.left,this.rulertop.css(f),a(".guide_h").css({width:n.call(this)})}function k(a){var b=m.call(this),c=b.left-this._options.rulerWidth,d=b.top-this._options.rulerWidth,e=n.call(this)+b.left,f=o.call(this)+b.top,g=a.pageX<c?c:a.pageX>e?e:a.pageX,h=a.pageY<d?d:a.pageY>f?f:a.pageY;return{coords:{x:g,y:h},bounds:{x:{min:c,max:e},y:{min:d,max:f}},isInside:g===a.pageX&&h===a.pageY}}function l(b,c){var d={},e=this.mousepos.width()+4,f=10,g=16;return d.absolute={left:b+f,top:c+g},d.absolute.left+e+f>a(window).width()&&(d.absolute.left=b-e-f),b-=a(this._options.reference).offset().left,c-=a(this._options.reference).offset().top,d.relative={left:Math.round(b),top:Math.round(c)},d}function m(){return a(this._options.reference).offset()}function n(){var b="body"==this._options.reference?document:this._options.reference,c=a(b),d=b==document?null:c.css("box-sizing");return c.width()+(d&&Number((-1===d.indexOf("-box")||0===d.indexOf("content"))&&parseInt(c.css("padding-left"))+parseInt(c.css("padding-right"))))}function o(){var b="body"==this._options.reference?document:this._options.reference,c=a(b),d=b==document?null:c.css("box-sizing");return c.height()+(d&&Number((-1===d.indexOf("-box")||0===d.indexOf("content"))&&parseInt(c.css("padding-top"))+parseInt(c.css("padding-left"))))}function p(a){return{left:a+"px",top:a+"px"}}function q(b){return a(b).attr("class").replace(/ruler_guideline|guide_| /g,"")}function r(b){return a(b).attr("class").replace(/rulers_|container| /g,"")}return c.prototype=Object.create(b.prototype),c.prototype.initOptions=function(a){this.setOptions({guidelinesContainer:"#ruler_guides",showMousePos:!0,showRulerV:!0,showRulerH:!0,rulerWidth:20,rulerUnit:5,rulerStepMin:2,rulerStepMed:5},a);var b=this._options;b.rulerMin||(b.rulerMin=b.rulerUnit),b.rulerMed||(b.rulerMed=b.rulerMin*b.rulerStepMin),b.rulerMax||(b.rulerMax=b.rulerMed*b.rulerStepMed)},c.prototype.initStyles=function(a){var b=this._options.rulerWidth,c=b/2,d=c/2;this._selectorsMapping={rulers_top:".ruler_origin",rulers_cont:".rulers_container",ruler_min:".ruler.ruler_min",ruler_med:".ruler.ruler_med",ruler_max:".ruler.ruler_max",ruler_label:".ruler .ruler_label",ruler_labelv:".rulers_v .ruler_label",ruler_labelh:".rulers_h .ruler_label",ruler_v:".rulers_v .ruler",ruler_h:".rulers_h .ruler",guide_v:".ruler_guideline.guide_v",guide_h:".ruler_guideline.guide_h",guideline:".ruler_guideline",mousepos:".ruler_mousepos",rulerv_min:".rulers_v .ruler_min",rulerv_med:".rulers_v .ruler_med",rulerv_max:".rulers_v .ruler_max",rulerh_min:".rulers_h .ruler_min",rulerh_med:".rulers_h .ruler_med",rulerh_max:".rulers_h .ruler_max"},this.setStyles({main:{position:"absolute",top:m.call(this).top+"px",left:m.call(this).left+"px"},rulers_cont:{position:"absolute",overflow:"hidden",background:"rgba(255,255,255,.8)"},rulers_v:{width:this._options.rulerWidth+"px",height:o.call(this)+"px",top:"0",left:"-"+this._options.rulerWidth+"px"},rulers_h:{height:this._options.rulerWidth+"px",width:n.call(this)+"px",left:"0",top:"-"+this._options.rulerWidth+"px"},ruler:{"z-index":"1",position:"absolute",border:"0 solid #000"},ruler_v:{"border-bottom-width":"1px",left:"0 !important"},ruler_h:{"border-right-width":"1px",top:"0 !important"},rulers_top:{"z-index":"2",position:"absolute",width:this._options.rulerWidth+"px",height:this._options.rulerWidth+"px",top:"-"+this._options.rulerWidth+"px",left:"-"+this._options.rulerWidth+"px",background:"#fff","border-right":"1px solid #000000","border-bottom":"1px solid #000000"},ruler_min:{width:this._options.rulerMin-1+"px",height:this._options.rulerMin-1+"px"},ruler_med:{width:this._options.rulerMed-1+"px",height:this._options.rulerMed-1+"px"},ruler_max:{width:this._options.rulerMax-1+"px",height:this._options.rulerMax-1+"px"},ruler_label:{position:"absolute","font-family":"helvetica","font-size":"8px",cursor:"default"},ruler_labelh:{bottom:"0px",right:"1px"},ruler_labelv:{bottom:"2px",right:"0px",width:"10px",transform:"rotate(-90deg)"},mousepos:{"z-index":"3",position:"absolute",width:"auto",height:"auto",background:"rgba(200,200,200,.8)",border:"1px solid #fff","font-size":"12px",padding:"1px 5px 3px","white-space":"nowrap"},guideline:{position:"absolute",background:"#0f0",width:"1px",height:"1px"},guide_v:{height:o.call(this)+"px",cursor:"ew-resize"},guide_h:{width:n.call(this)+"px",cursor:"ns-resize"}},{ruler_labelv:{"-webkit-transform":"rotate(-90deg)","-moz-transform":"rotate(-90deg)","-ms-transform":"rotate(-90deg)","-o-transform":"rotate(-90deg)",filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)"}},a,{rulerv_min:{width:d+"px !important"},rulerv_med:{width:c+"px !important"},rulerv_max:{width:b+"px !important"},rulerh_min:{height:d+"px !important"},rulerh_med:{height:c+"px !important"},rulerh_max:{height:b+"px !important"}})},c.prototype.createSubElements=function(){this.$el.addClass("rulers"),this.rulers_v=a("<div/>").addClass("rulers_container").addClass("rulers_v"),this.rulers_h=a("<div/>").addClass("rulers_container").addClass("rulers_h"),this.ruler=a("<div/>").addClass("ruler"),this.ruler_lab=a("<div/>").addClass("ruler_label"),this.rulertop=a("<div/>").addClass("ruler_origin"),this.mousepos=a("<div/>").addClass("ruler_mousepos"),this.guideline=a("<div/>").addClass("ruler_guideline"),this.guides=a("<div/>").attr("id","ruler_guides"),d.call(this)},c.prototype.initEvents=function(){this.$el.off(".guidesevent").on("mousedown.guidesevent",".rulers_container",f.bind(this)).on("mousedown.guidesevent",".ruler_guideline",g.bind(this)),a("body").off(".guidesevent").on("mousemove.guidesevent",e.bind(this)).on("mouseup.guidesevent",h.bind(this)).on("keydown.guidesevent",i.bind(this)),a(window).off(".rulersevent").on("scroll.rulersevent resize.rulersevent",j.bind(this))},c.prototype.afterInit=function(){j.call(this)},c}(jQuery,a);return b}();