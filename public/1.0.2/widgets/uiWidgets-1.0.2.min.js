/*! Full Widgets Package - v1.0.2 - 2015-03-16 */
var UIBaseWidget=function(a){function b(a,b){this.$el=null,this._ID=a,this._selectorsMapping=null,this._globalSelectors=null,this._styles={},this._options={extension:{},reference:"body"},this._init(b)}return b.prototype={initOptions:function(){},initStyles:function(){},initEvents:function(){},createSubElements:function(){},afterInit:function(){},appendTo:function(b){b&&(b instanceof String&&(b=a(b)),this.$el.appendTo(b))},show:function(){this.$el.show()},hide:function(){this.$el.hide()},setOptions:function(){for(var a in arguments)arguments.hasOwnProperty(a)&&this._extendObject(this._options,arguments[a])},setStyles:function(){for(var a in arguments)arguments.hasOwnProperty(a)&&this._extendObject(this._styles,arguments[a])},_init:function(a){this.initOptions(a),this.initStyles(this._options.extension),this._createElement(),this._createStyleTag(),this.initEvents(),this.afterInit()},_createElement:function(){var b=a("#"+this._ID);b.length>0&&(b.remove(),console.log("Container ID already in use and thus has been removed.")),this.$el=a("<div/>").attr("id",this._ID),this.createSubElements()},_createStyleTag:function(){var b=this._ID+"-style";a("#"+b).remove();var c,d,e,f,g,h=a("<style/>").attr("id",b);for(e in this._styles)this._styles.hasOwnProperty(e)&&(f=this._styles[e],d=this._selectorsMapping&&this._selectorsMapping[e],g=this._globalSelectors&&this._globalSelectors[e],c=g?"":"#"+this._ID,"main"!=e&&(c+=" "+(d||"."+e)),h.append(c+" {"+this._styleObjectToString(f)+"}"));a("head").append(h)},_extendObject:function(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]&&a[c]instanceof Object&&!(a[c]instanceof Array)?this._extendObject(a[c],b[c]):a[c]=b[c])},_styleObjectToString:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c+":"+a[c]+";");return b.join("")}},b}(jQuery),UIMarkerWidget=function(a,b){function c(a,c){b.call(this,a,c)}function d(a){var b,c=this._options.checkUseMarker?this._options.checkUseMarker():!0,d=this._options.checkUseFont?this._options.checkUseFont():!0;return c||d?(b=n(a),c&&e.call(this,a,b),d&&f.call(this,a,b),!0):!1}function e(b,c){var d=this._options.markerData;if(a(b).data(d)===!0)return!0;c||(c=n(b));var e=a('<div class="'+this._options.markerClass+'"/>').width(c.width).height(c.height).offset(c.offset).click(function(b){h.call(this,a(b.currentTarget),d)}.bind(this));g.call(this,b,e,d)}function f(b,c){var d=this._options.fontData;if(a(b).data(d)===!0)return!0;c||(c=n(b));var e=m(b),f=a('<p class="fi1"/>').text(e[0]),i=a('<p class="fi2"/>').text(e[1]),j=a('<p class="fi3"/>').text(e[2]),k=a('<div class="'+this._options.fontClass+'"/>').append(f,i,j).offset({top:c.offset.top-45,left:c.offset.left+10}).click(function(b){h.call(this,a(b.currentTarget),d)}.bind(this));g.call(this,b,k,d)}function g(b,c,d){a(b).data(d,!0),a(c).data("ref",b),this.$el.append(c)}function h(b,c){a(a(b).data("ref")).data(c,!1),a(b).remove()}function i(){var b=r(this._options.taglist);a(b).off(".prevent").on("click.prevent",function(c){a(c.target).is(b)&&0===a(c.target).closest(this._options.excluded).length&&c.preventDefault()}.bind(this))}function j(){var b=r(this._options.taglist);a(b).off(".prevent")}function k(a){return s.call(this,a.target)?!d.call(this,a.target):!0}function l(b){return a(b.currentTarget).remove(),!1}function m(b){var c=a(b),d=c.css("font-weight"),e=c.css("font-size").replace("px",""),f=c.css("font-family").split(",")[0].replace(/\"|'/g,""),g=f.split(" ")[0].substr(0,1).toUpperCase(),h=f.split(" ")[1]?f.split(" ")[1].substr(0,1).toUpperCase():f.substr(1,1).toLowerCase(),i=g+h;return[i,d,e]}function n(b){var c=o(b),d=a(b);return{width:d.width(),height:d.height()-(c.t+c.b),offset:{left:d.offset().left+parseInt(d.css("padding-left")),top:d.offset().top+parseInt(d.css("padding-top"))+c.t}}}function o(b){var c=a(b),d=!0,e=c.css("font-weight"),f=c.css("font-size").replace("px",""),g=c.css("font-family").split(",")[0].replace(/\"|\'| /g,"").toLowerCase(),h={arial:q(),"open sans":q()};if(h.arial[8]=p(0,0),h.arial[12]=p(3,1),h.arial[18]=p(2,-1),h.arial[20]=p(6,3),h["open sans"][12]=p(1,-1),h["open sans"][21]=p(5,1),h["open sans"][26]=p(11,5),d){var i=[];i.push('family:"'+g+'" - size:'+f+" - weight:"+e),h[g]||i.push("fontFAMILY not used.. we'll implement it soon!"),h[g]&&(!h[g][f]||0===h[g][f].t&&0===h[g][f].b)&&i.push("fontSIZE not used.. we'll implement it soon!"),i.push("-----------------"),console.log(i.join("\n"))}var j;return j=h[g]?h[g]:q(),j=j[f]?j[f]:j[8]}function p(a,b){return{t:a&&0!==a?a:0,b:b&&0!==b?b:0}}function q(){return{8:p(),9:p(),10:p(),11:p(),12:p(),13:p(),14:p(),15:p(),16:p(),17:p(),18:p(),19:p(),20:p(),21:p(),22:p(),23:p(),24:p(),25:p(),26:p(),27:p(),28:p(),29:p()}}function r(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&a[c]&&b.push(c);return b.join(",")}function s(b){var c=a(b);if(""!==this._options.excluded&&c.closest(this._options.excluded).length>0)return!1;var d=""!==c.html()&&""!==c.text()&&" "!==c.text()&&"&nbsp;"!==c.text();if(d){var e,f=this._options.taglist;for(e in f)if(f.hasOwnProperty(e)&&f[e]&&c.is(e))return!0;if(c.is("div")&&0===c.find("*").length)return!0}return!1}return c.prototype=Object.create(b.prototype),c.prototype.initOptions=function(a){this.setOptions({checkUseMarker:null,checkUseFont:null,markerClass:"fiboMarker",fontClass:"fiboFontinfo",markerData:"markerHL",fontData:"markerFI",excluded:"",taglist:{p:!0,span:!0,strong:!0,li:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,a:!0,input:!0,select:!0,textfield:!0,label:!0}},a),this._options.excluded=(""===this._options.excluded?"":this._options.excluded+",")+"."+this._options.fontClass},c.prototype.initStyles=function(a){var b=this._options.markerClass,c=this._options.fontClass;this._selectorsMapping={marker:"."+b,fontinfo:"."+c,fontinfo_p:"."+c+" p",fontinfo_p1:"."+c+" p.fi1",fontinfo_p2:"."+c+" p.fi2",fontinfo_p3:"."+c+" p.fi3"},this.setStyles({main:{position:"absolute"},marker:{position:"absolute !important","z-index":"1",background:"#0ff",opacity:"0.5"},fontinfo:{position:"absolute !important","z-index":"2",background:"rgba(34, 34, 34, 0.7)",border:"1px solid #fff",padding:"3px","font-family":"Open Sans",color:"#fff"},fontinfo_p:{margin:"0",cursor:"default","text-algin":"center"},fontinfo_p1:{"font-size":"13px","font-weight":"700","margin-top":"-4px"},fontinfo_p2:{"font-size":"10px","font-weight":"400",margin:"-5px 0"},fontinfo_p3:{"font-size":"14px","font-weight":"600","margin-bottom":"-4px"}},a)},c.prototype.initEvents=function(){var b=this._options.reference,c="."+this._options.markerClass,d=r(this._options.taglist);a(b).off(".markerevent").on("click.markerevent",k.bind(this)).on("click.markerevent",c,l.bind(this)),a(d).data(this._options.markerData,null),a(d).data(this._options.fontData,null)},c.prototype.toggleListener=function(a){a?i.call(this):j.call(this)},c.prototype.addMarkerToElement=function(a){return d.call(this,a)},c.prototype.markEvent=function(a){return k.call(this,a)},c.prototype.unmarkEvent=function(a){return l.call(this,a)},c}(jQuery,UIBaseWidget),UIRulerWidget=function(a,b){function c(a,c){b.call(this,a,c)}function d(){var b,c,d,e,f=this.ruler.clone().addClass("ruler_min"),g=this.ruler.clone().addClass("ruler_med"),h=this.ruler.clone().addClass("ruler_max"),i=Math.floor(this._options.rulerMed/this._options.rulerMin),j=Math.floor(this._options.rulerMax/this._options.rulerMed),k=Math.ceil(o.call(this)/this._options.rulerMax),l=Math.ceil(n.call(this)/this._options.rulerMax);for(b=0;i>b;b++)g.append(f.clone().css(p(b*this._options.rulerMin)));for(c=0;j>c;c++)h.append(g.clone().css(p(c*this._options.rulerMed)));if(this._options.showRulerH){for(d=0;l>d;d++)this.rulers_h.append(h.clone().css(p(d*this._options.rulerMax)).append(this.ruler_lab.clone().text((d+1)*this._options.rulerMax)));this.$el.append(this.rulers_h)}if(this._options.showRulerV){for(e=0;k>e;e++)this.rulers_v.append(h.clone().css(p(e*this._options.rulerMax)).append(this.ruler_lab.clone().text((e+1)*this._options.rulerMax)));this.$el.append(this.rulers_v)}this._options.showMousePos&&0===a("#").length&&this.$el.append(this.mousepos),this.$el.append(this.rulertop),this.$el.append(this.guides)}function e(a){if(this._options.showMousePos){var b=l.call(this,a.pageX,a.pageY),c="x:"+b.relative.left+", y:"+b.relative.top;this.mousepos.offset(b.absolute),this.mousepos.text(c)}if(this.guide_dragging){var d,e=q(this.guide_dragging),f=m.call(this),g=k.call(this,a);return"v"===e&&(d={top:f.top,left:g.coords.x}),"h"===e&&(d={left:f.left,top:g.coords.y}),this.guide_dragging.offset(d),!1}return!0}function f(b){var c=r(b.currentTarget),d=this.guideline.clone().addClass("guide_"+c),f=a(this._options.guidelinesContainer);return f.append(d),this.guide_dragging=d,this.guide_dragged=null,e.call(this,b),!1}function g(b){return this.guide_dragging=a(b.currentTarget),this.guide_dragged=null,e.call(this,b),!1}function h(b){var c=k.call(this,b),d=a(b.target).closest(".rulers_container").length>0,e=b.pageX>c.bounds.x.min&&b.pageX<c.bounds.x.max&&b.pageY>c.bounds.y.min&&b.pageY<c.bounds.y.max;!this.guide_dragging||!d&&e||(this.guide_dragging.remove(),this.guide_dragging=null),this.guide_dragged=this.guide_dragging,this.guide_dragging=null}function i(a){var b=a.shiftKey?10:a.altKey?.5:1;if(this.guide_dragged&&a.keyCode>=37&&a.keyCode<=40){var c={top:this.guide_dragged.position().top+(38===a.keyCode?-b:40===a.keyCode?b:0),left:this.guide_dragged.position().left+(37===a.keyCode?-b:39===a.keyCode?b:0)};return"v"===q(this.guide_dragged)&&this.guide_dragged.css({left:c.left}),"h"===q(this.guide_dragged)&&this.guide_dragged.css({top:c.top}),!1}return!0}function j(){var b=m.call(this).top-a(window).scrollTop()-this._options.rulerWidth,c=m.call(this).left-a(window).scrollLeft()-this._options.rulerWidth;this.$el.css({top:m.call(this).top,left:m.call(this).left});var d=0>=b?{position:"fixed",top:"0",left:m.call(this).left}:{position:"absolute",top:-this._options.rulerWidth,left:0},e=0>=c?{left:-m.call(this).left+a(window).scrollLeft()}:{left:-this._options.rulerWidth};this.rulers_h.css(d),this.rulers_v.css(e);var f={top:d.top,position:d.position};f.left=0>=b?this.rulers_v.offset().left:e.left,this.rulertop.css(f),a(".guide_h").css({width:n.call(this)})}function k(a){var b=m.call(this),c=b.left-this._options.rulerWidth,d=b.top-this._options.rulerWidth,e=n.call(this)+b.left,f=o.call(this)+b.top,g=a.pageX<c?c:a.pageX>e?e:a.pageX,h=a.pageY<d?d:a.pageY>f?f:a.pageY;return{coords:{x:g,y:h},bounds:{x:{min:c,max:e},y:{min:d,max:f}},isInside:g===a.pageX&&h===a.pageY}}function l(b,c){var d={},e=this.mousepos.width()+4,f=10,g=16;return d.absolute={left:b+f,top:c+g},d.absolute.left+e+f>a(window).width()&&(d.absolute.left=b-e-f),b-=a(this._options.reference).offset().left,c-=a(this._options.reference).offset().top,d.relative={left:Math.round(b),top:Math.round(c)},d}function m(){return a(this._options.reference).offset()}function n(){return a(this._options.reference).width()+Number(a(this._options.reference).css("padding-left").replace("px",""))+Number(a(this._options.reference).css("padding-right").replace("px",""))}function o(){return a(this._options.reference).height()+Number(a(this._options.reference).css("padding-top").replace("px",""))+Number(a(this._options.reference).css("padding-bottom").replace("px",""))}function p(a){return{left:a+"px",top:a+"px"}}function q(b){return a(b).attr("class").replace(/ruler_guideline|guide_| /g,"")}function r(b){return a(b).attr("class").replace(/rulers_|container| /g,"")}return c.prototype=Object.create(b.prototype),c.prototype.initOptions=function(a){this.setOptions({guidelinesContainer:"#ruler_guides",showMousePos:!0,showRulerV:!0,showRulerH:!0,rulerWidth:20,rulerUnit:5,rulerStepMin:2,rulerStepMed:5},a);var b=this._options;b.rulerMin||(b.rulerMin=b.rulerUnit),b.rulerMed||(b.rulerMed=b.rulerMin*b.rulerStepMin),b.rulerMax||(b.rulerMax=b.rulerMed*b.rulerStepMed)},c.prototype.initStyles=function(a){var b=this._options.rulerWidth,c=b/2,d=c/2;this._selectorsMapping={rulers_top:".ruler_origin",rulers_cont:".rulers_container",ruler_min:".ruler.ruler_min",ruler_med:".ruler.ruler_med",ruler_max:".ruler.ruler_max",ruler_label:".ruler .ruler_label",ruler_labelv:".rulers_v .ruler_label",ruler_labelh:".rulers_h .ruler_label",ruler_v:".rulers_v .ruler",ruler_h:".rulers_h .ruler",guide_v:".ruler_guideline.guide_v",guide_h:".ruler_guideline.guide_h",guideline:".ruler_guideline",mousepos:".ruler_mousepos",rulerv_min:".rulers_v .ruler_min",rulerv_med:".rulers_v .ruler_med",rulerv_max:".rulers_v .ruler_max",rulerh_min:".rulers_h .ruler_min",rulerh_med:".rulers_h .ruler_med",rulerh_max:".rulers_h .ruler_max"},this.setStyles({main:{position:"absolute",top:m.call(this).top+"px",left:m.call(this).left+"px"},rulers_cont:{position:"absolute",overflow:"hidden",background:"rgba(255,255,255,.8)"},rulers_v:{width:this._options.rulerWidth+"px",height:o.call(this)+"px",top:"0",left:"-"+this._options.rulerWidth+"px"},rulers_h:{height:this._options.rulerWidth+"px",width:n.call(this)+"px",left:"0",top:"-"+this._options.rulerWidth+"px"},ruler:{"z-index":"1",position:"absolute",border:"0 solid #000"},ruler_v:{"border-bottom-width":"1px",left:"0 !important"},ruler_h:{"border-right-width":"1px",top:"0 !important"},rulers_top:{"z-index":"2",position:"absolute",width:this._options.rulerWidth+"px",height:this._options.rulerWidth+"px",top:"-"+this._options.rulerWidth+"px",left:"-"+this._options.rulerWidth+"px",background:"#fff","border-right":"1px solid #000000","border-bottom":"1px solid #000000"},ruler_min:{width:this._options.rulerMin-1+"px",height:this._options.rulerMin-1+"px"},ruler_med:{width:this._options.rulerMed-1+"px",height:this._options.rulerMed-1+"px"},ruler_max:{width:this._options.rulerMax-1+"px",height:this._options.rulerMax-1+"px"},ruler_label:{position:"absolute","font-family":"helvetica","font-size":"8px",cursor:"default"},ruler_labelh:{bottom:"0px",right:"1px"},ruler_labelv:{bottom:"2px",right:"0px",width:"10px",transform:"rotate(-90deg)"},mousepos:{"z-index":"3",position:"absolute",width:"auto",height:"auto",background:"rgba(200,200,200,.8)",border:"1px solid #fff","font-size":"12px",padding:"1px 5px 3px","white-space":"nowrap"},guideline:{position:"absolute",background:"#0f0",width:"1px",height:"1px"},guide_v:{height:o.call(this)+"px",cursor:"ew-resize"},guide_h:{width:n.call(this)+"px",cursor:"ns-resize"}},{ruler_labelv:{"-webkit-transform":"rotate(-90deg)","-moz-transform":"rotate(-90deg)","-ms-transform":"rotate(-90deg)","-o-transform":"rotate(-90deg)",filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)"}},a,{rulerv_min:{width:d+"px !important"},rulerv_med:{width:c+"px !important"},rulerv_max:{width:b+"px !important"},rulerh_min:{height:d+"px !important"},rulerh_med:{height:c+"px !important"},rulerh_max:{height:b+"px !important"}})},c.prototype.createSubElements=function(){this.$el.addClass("rulers"),this.rulers_v=a("<div/>").addClass("rulers_container").addClass("rulers_v"),this.rulers_h=a("<div/>").addClass("rulers_container").addClass("rulers_h"),this.ruler=a("<div/>").addClass("ruler"),this.ruler_lab=a("<div/>").addClass("ruler_label"),this.rulertop=a("<div/>").addClass("ruler_origin"),this.mousepos=a("<div/>").addClass("ruler_mousepos"),this.guideline=a("<div/>").addClass("ruler_guideline"),this.guides=a("<div/>").attr("id","ruler_guides"),d.call(this)},c.prototype.initEvents=function(){a(this.$el).off(".guidesevent").on("mousedown.guidesevent",".rulers_container",f.bind(this)).on("mousedown.guidesevent",".ruler_guideline",g.bind(this)),a("body").off(".guidesevent").on("mousemove.guidesevent",e.bind(this)).on("mouseup.guidesevent",h.bind(this)).on("keydown.guidesevent",i.bind(this)),a(window).off(".rulersevent").on("scroll.rulersevent resize.rulersevent",j.bind(this))},c.prototype.afterInit=function(){j.call(this)},c}(jQuery,UIBaseWidget),UISliderWidget=function(a,b){function c(a,c){this.sliding=!1,this.mousezero=0,b.call(this,a,c)}function d(a){var b=Math.floor(10*i.call(this,a))/10;return this.slider_output.text(b),this._options.callback&&this._options.callback(a,b),b}function e(b){return a(b.target).is(this.slider_output)?!0:(this.slider_handler.css("left",j.call(this,b,-(this.slider_handler.width()/2))),f.call(this,b),!1)}function f(a){return this.mousezero=this.slider_handler.position().left-k.call(this,a.pageX),this.sliding=!0,h.call(this,a),!1}function g(){return this.sliding=!1,!1}function h(a){return this.sliding&&this.setSliderPerc(j.call(this,a)/l.call(this)),!1}function i(a){var b=this._options.minValue,c=this._options.maxValue,d=this._options.stepValue;return Math.round((b+a*(c-b))/d)*d}function j(a,b){b&&(this.mousezero=b);var c,d=l.call(this);c=k.call(this,a.pageX)+this.mousezero,c=0>c?0:c>d?d:c;var e=this._options.stepValue/(this._options.maxValue-this._options.minValue)*d;return c=Math.floor((c+e/2)/e)*e}function k(a){return a-this.$el.offset().left}function l(){return this.$el.width()-this.slider_handler.width()}return c.prototype=Object.create(b.prototype),c.prototype.initOptions=function(a){this.setOptions({minValue:0,maxValue:100,initialValue:100,stepValue:1,callback:null},a);var b=this._options;b.maxValue<=b.minValue&&(b.maxValue=b.minValue+b.stepValue),b.initialValue<=b.minValue&&(b.initialValue=b.minValue),b.initialValue>=b.maxValue&&(b.initialValue=b.maxValue)},c.prototype.initStyles=function(a){this.setStyles({main:{position:"relative",width:"100px",height:"20px",background:"rgba(100,100,100,.4)"},slider_bar:{position:"absolute",width:"100%",height:"3px",background:"rgb(200,200,200)",top:"9px"},slider_handler:{position:"absolute",width:"10px",height:"20px",background:"rgb(100,100,100)",top:"0",left:"0"},slider_output:{position:"absolute",width:"34px",height:"20px",background:"#fff",top:"0",right:"-34px","text-indent":"0","text-align":"center","font-size":"12px","line-height":"20px",cursor:"default"}},a)},c.prototype.createSubElements=function(){this.$el.addClass("slider"),this.slider_bar=a("<div/>").addClass("slider_bar"),this.slider_handler=a("<div/>").addClass("slider_handler"),this.slider_output=a("<div/>").addClass("slider_output"),this.$el.append(this.slider_bar).append(this.slider_handler).append(this.slider_output)},c.prototype.initEvents=function(){var b=".slider_"+this._ID;this.$el.off(b).on("mousedown"+b,e.bind(this)).on("mousedown"+b,".slider_handler",f.bind(this)),a("body").off(b).on("mousemove"+b,h.bind(this)).on("mouseup"+b,g.bind(this))},c.prototype.afterInit=function(){this.setSliderVal(this._options.initialValue)},c.prototype.setSliderVal=function(a){var b=(a-this._options.minValue)/(this._options.maxValue-this._options.minValue);this.setSliderPerc(b)},c.prototype.setSliderPerc=function(a){var b=a*l.call(this);this.slider_handler.css("left",b),d.call(this,a)},c.prototype.getSliderVal=function(){return d.call(this,this.getSliderPerc())},c.prototype.getSliderPerc=function(){var a=this.slider_handler.css("left").replace("px","");return a/l.call(this)},c}(jQuery,UIBaseWidget),UISpacerWidget=function(a,b){function c(a,c){this.defaultGroupName="spacerGroup_",this.lastUsedGroup=this.defaultGroupName+"1",this.spacersGroups={},this.mousezero=null,this.dragging=null,this.dragged=null,b.call(this,a,c),this.spacerObjects=x.call(this)}function d(a,b,c){return g.call(this,a,b,c)}function e(b){return b&&this.spacersGroups[b]?(a("#"+b).remove(),delete this.spacersGroups[b],!0):!1}function f(){return this.$el.empty(),this.spacersGroups={},!0}function g(b,c,d){b||(b=this.lastUsedGroup);var e=a("#"+b);return 0===e.length&&(e=a("<div/>").attr("id",b).addClass("spacers_group"),c||this.$el.append(e),!d&&this._options.groupCallback&&this._options.groupCallback(b)),this.lastUsedGroup=b,e}function h(){var b,c={};this.$el.find("."+this._options.spacerClass).each(function(d,e){var f=a(e);b=f.parent().attr("id"),b===this._ID&&(b="spacerGroupDefault"),c[b]||(c[b]=[]),c[b].push([parseInt(this.getSpacerType.call(this,e)),Number(f.css("top").replace("px","")),Number(f.css("left").replace("px",""))])}.bind(this)),this.spacersGroups=c}function i(){return h.call(this),JSON.stringify(this.spacersGroups)}function j(a,b,c){var d,e=JSON.parse(a);for(var f in e)e.hasOwnProperty(f)&&(b?(delete this.spacersGroups[f],d=e[f]):(d=this.spacersGroups[f],d||(d=[]),d.push.apply(d,e[f])),this.spacersGroups[f]=d);return k.call(this,c)}function k(b){var c,e,f,g,h,i=[];for(var j in this.spacersGroups)if(this.spacersGroups.hasOwnProperty(j)){g=[],e=this.spacersGroups[j],a("#"+j).remove();for(var k=0;k<e.length;k++)c="f_"+("000"+e[k][0]).substr(-3),f=this.spacerObjects[c].clone(),f.css("top",e[k][1]),f.css("left",e[k][2]),g.push(f.prop("outerHTML"));this._options.grouping?(h=d.call(this,j,!0,!0),h.html(g.join("")),b&&h.hide(),i.push(h.prop("outerHTML"))):i.push(g.join(""))}return i.join("")}function l(a,b,c){var d=j.call(this,a,b,c);this.$el.html(d)}function m(){var a,b,c,d,e="65",f=this._options.spacerMin-1,g=A.call(this,f),h=[],i=this._options.spacerColors,j=this._options.spacerSymbols,k=i.length,l=j.length,m=f,n=0;m>=k&&(m-=Math.floor(m/k)*k),h.after={position:"absolute",left:"0",color:"#fff","-khtml-opacity":"."+e,"-moz-opacity":"."+e,"-ms-filter":'"alpha(opacity='+e+')"',filter:"alpha(opacity="+e+")",opacity:"."+e};for(var o in g)g.hasOwnProperty(o)&&(b=g[o],a=z.call(this,b),c=("000"+b).substr(-3),d=this._options.spacerClass+".fs_"+c,h[d]={width:g[o]+"px",height:g[o]+"px",background:i[m]},this._globalSelectors[d]=!0,a>=k&&(h[d+":after"]={content:'"'+j[n].s+'"',"font-size":Number(b*j[n].f)+"px","line-height":Number(b*j[n].l)+"px"},this._globalSelectors[d+":after"]=!0,(a+1)%k===0&&++n>=l&&(n=l-1)),++m>=k&&(m=0));return h}function n(a){var b=Math.round(a%1*100)/100,c=.25>b?0:b>.75?1:.5;return Math.floor(a)+c}function o(a){var b={top:n(Number(a.css("top").replace("px",""))),left:n(Number(a.css("left").replace("px","")))};a.css(b)}function p(){var a=0;for(var b in this.spacersGroups)this.spacersGroups.hasOwnProperty(b)&&a++;return a}function q(a){var b=a.shiftKey?10:a.altKey?.5:1;return this.dragged&&a.keyCode>=37&&a.keyCode<=40?(this.dragged.offset({top:this.dragged.offset().top+(38===a.keyCode?-b:40===a.keyCode?b:0),left:this.dragged.offset().left+(37===a.keyCode?-b:39===a.keyCode?b:0)}),this._options.moveCallback&&this._options.moveCallback(this.dragged),!1):!0}function r(a){switch(a.type){case"mousedown":t.call(this,a);case"mousemove":v.call(this,a);break;case"mouseup":w.call(this,a)}}function s(){this.$el.css(B.call(this))}function t(b){var c=a(b.target);return this.mousezero={top:c.position().top-b.pageY+B.call(this).top,left:c.position().left-b.pageX+B.call(this).left},u.call(this,c),!1}function u(a){a.parent().append(a),this.dragged=null,this.dragging=a}function v(a){return this.dragging?(this.dragging.offset({top:Number(a.pageY+this.mousezero.top),left:Number(a.pageX+this.mousezero.left)}),o(this.dragging),!1):!0}function w(){return this.dragged=this.dragging,this.dragged?(this.dragged.focus(),void(this.dragging&&(this.dragging=null,this._options.moveCallback&&this._options.moveCallback(this.dragged)))):!0}function x(){for(var b,c={},d=this._options.spacerMin-1;d<this._options.spacersList.length;d++)b=("00"+this._options.spacersList[d]).substr(-3),c["f_"+b]=a("<div/>").addClass(this._options.spacerClass+" fs_"+b).attr("tabindex","");return c}function y(a,b){for(var c=1,d=1,e=0,f=[],g=1;b>=g;g++)c+=e,e=d,d=c,f.push(c);return 0>=a&&(a=1),f.splice(a-1,b-a+1)}function z(a){var b=this._options.spacersList;for(var c in b)if(b.hasOwnProperty(c)&&b[c]===a)return Number(c);return-1}function A(a,b){(!a||0>a)&&(a=0),(!b||b>this._options.spacersList.length-1)&&(b=this._options.spacersList.length-1);for(var c=[],d=a;b>=d;d++)c.push(this._options.spacersList[d]);return c}function B(){return a(this._options.reference).offset()}return c.prototype=Object.create(b.prototype),c.prototype.initOptions=function(a){this.setOptions({localStorage:"fibonacciGroups",spacerClass:"fibospacer",spacerMatch:/fibospacer|fs|_| /g,grouping:!0,moveCallback:null,groupCallback:null,spacersList:y(1,12),spacerMin:3,spacerSymbols:[{s:"•",f:2.8,l:1},{s:"★",f:1,l:1.09}],spacerColors:["#0071bc","#ed1e79","#8cc63f","#fbb03b"]},a)},c.prototype.initStyles=function(a){var b="0 0 5px 2px #222222 inset";this._selectorsMapping={spacer:"."+this._options.spacerClass,shadow:"."+this._options.spacerClass+":focus",after:"."+this._options.spacerClass+":after"},this._globalSelectors={spacer:!0,shadow:!0,after:!0},this.setStyles({main:{position:"absolute",top:B.call(this).top+"px",left:B.call(this).left+"px",width:"0",height:"0",overflow:"visible"},spacer:{position:"absolute",display:"block",cursor:"pointer",overflow:"hidden","font-family":"Arial",outline:"0"},shadow:{"-webkit-box-shadow":b,"-moz-box-shadow":b,"box-shadow":b}},m.call(this),a)},c.prototype.initEvents=function(){this.$el.off(".spacerevent").on("mousedown.spacerevent","."+this._options.spacerClass,r.bind(this)),a("body").off(".spacerevent").on("mousemove.spacerevent",r.bind(this)).on("mouseup.spacerevent",r.bind(this)).on("keydown.spacerevent",q.bind(this)),a(window).off(".spacerevent").on("scroll.spacerevent resize.spacerevent",s.bind(this))},c.prototype.getFibonacci=function(a,b){y(a,b)},c.prototype.getSpacersList=function(a){return A.call(this,a?this._options.spacerMin-1:0)},c.prototype.getSpacerType=function(b){return a(b).attr("class").replace(this._options.spacerMatch,"")},c.prototype.updateGroups=function(){h.call(this)},c.prototype.selectGroup=function(a){this.lastUsedGroup=a?a:this.defaultGroupName+(p.call(this)+1)},c.prototype.setMouseZero=function(a){!a.top&&0!==a.top||!a.left&&0!==a.left?console.log("WARNING: setMouseZero called with wrong parameter"):this.mousezero=a},c.prototype.dragSpacer=function(a){u.call(this,a)},c.prototype.renameGroup=function(b,c){if(!b||!c)return!1;if(b===c)return!1;if(a("#"+c).length>0)return!1;var f=this.spacersGroups[b];if(!f)return!1;this.spacersGroups[c]=f;var g=d.call(this,c);return g.html(a("#"+b).html()),e.call(this,b),!0},c.prototype.offsetGroup=function(b){var c,d,e=this.spacersGroups[this.lastUsedGroup],f=a("#"+this.lastUsedGroup).find("."+this._options.spacerClass);e&&f.each(function(f,g){var h=a(g);c=Number(e[f][1]),d=Number(e[f][2]),h.css("top",c+Number(b.top)),h.css("left",d+Number(b.left))})},c.prototype.saveOffsetGroup=function(a){var b,c=this.spacersGroups[this.lastUsedGroup];if(c){for(b in c)c.hasOwnProperty(b)&&(c[b][1]=Number(c[b][1])+Number(a.top),c[b][2]=Number(c[b][2])+Number(a.left));this.spacersGroups[this.lastUsedGroup]=c}},c.prototype.offsetCustomGroup=function(b,c){for(var d=0;d<b.length;d++){var e=a(b[d]),f=e.offset(),g={left:f.left+Number(c.left),top:f.top+Number(c.top)};e.offset(g)}},c.prototype.addNewSpacer=function(a,b){if(-1==z.call(this,a))return console.log("WARNING: addSpacer called with unsupported spacer"),null;b||(b=this.lastUsedGroup);var c=("000"+a).substr(-3),e=this.spacerObjects["f_"+c].clone(),f=this._options.grouping?d.call(this,b):this.$el;return e&&f.append(e),e},c.prototype.jsonToString=function(a,b){b||(b="; ");var c=JSON.parse(a),d=0,e=[];for(var f in c)c.hasOwnProperty(f)&&(d++,e.push("  group name: "+f),e.push("    spacers count: "+c[f].length));return e.unshift("groups count: "+d),e.join(b)},c.prototype.setLocalStorage=function(){return localStorage.setItem(this._options.localStorage,i.call(this)),!0},c.prototype.getLocalStorage=function(a){f.call(this);var b=localStorage.getItem(this._options.localStorage);return b&&l.call(this,b,!0,a),b},c.prototype.loadSpacersFromJson=function(a,b){return a&&l.call(this,a,!0,b),a},c}(jQuery,UIBaseWidget),UISpriterWidget=function(a,b){function c(c,d){this.spritesInfo={},this.spritesTotal=0,this.spritesLoaded=0,b.call(this,c,d),s.call(this),a(window).off(".uiSpriter").on("resize.uiSpriter",s.bind(this))}function d(){return"hidden"===this.$el.css("visibility")?!1:(this._options.visible||j(this.$el),!0)}function e(a){return(a?this.spritesLoaded:++this.spritesLoaded)<this.spritesTotal?!1:(this._options.visible||k(this.$el),this._options.callback&&this._options.callback(this.spritesInfo),!0)}function f(b,c){var d=a(this._options.reference),e=d.find("*");return console.log("calculating... (please, wait until done!)"),e.each(function(b,c){var d=a(c),e=d.css("background-image"),f=""===this._options.domain;if(!f&&e.indexOf(this._options.domain)>-1&&(f=!0),f&&"url"!==e.substr(0,3)&&(f=!1),f&&-1===e.indexOf("http")&&(f=!1),f){var h=g(d),i=p(d.css("padding-left"))+p(d.css("padding-right")),j=p(d.css("padding-top"))+p(d.css("padding-bottom")),k={l:h.x,t:h.y},l={w:i+d.width(),h:j+d.height()};e&&"none"!==e&&(this.spritesInfo[e]||(this.spritesInfo[e]=[]),this.spritesInfo[e].push({pos:k,size:l}))}}.bind(this)),console.log("DONE!"),this.spritesTotal=o.call(this),b?(b(this.spritesInfo,c),!0):this.spritesInfo}function g(a){var b=a.css("background-image"),c=h(b),d=a.width(),e=a.height(),f=a.css("background-position").split(" "),g=f[0],i=f[1];return g="left"==g||"0%"==g?0:"center"==g||"50%"==g?-(c.width-d)/2:"right"==g||"100%"==g?-(c.width-d):parseInt(g),i="top"==i||"0%"==i?0:"center"==i||"50%"==i?-(c.height-e)/2:"bottom"==i||"100%"==i?-(c.height-e):parseInt(i),{x:-g,y:-i}}function h(b){var c=b.replace(/url\((['"])?(.*?)\1\)/gi,"$2").split(",")[0],d=a("<img/>").attr("src",c);return{width:d.prop("width"),height:d.prop("height")}}function i(b){var c,d,e,f;for(var g in b)if(b.hasOwnProperty(g)){f=this.filenameFromCss(g,!0).replace(/[.]/g,"_"),d=n(b[g]),e=a("<div/>").attr("id",f).addClass("obscurers_container"),c=l.call(this,g,e),e.append(c);for(var h in d)d.hasOwnProperty(h)&&e.append(d[h]);this.$el.append(e)}}function j(a){a.css("visibility","hidden").show()}function k(a){a.css("visibility","visible").hide()}function l(b,c){d.call(this);var f=h(b);return c.css(f),this._options.visible||k(c),e.call(this),a("<img/>").attr("src",q(b))}function m(b){var c="top:"+b.pos.t+"px; left:"+b.pos.l+"px; width:"+b.size.w+"px; height:"+b.size.h+"px;";return a("<div/>").addClass("sprite_obscurer").attr("style",c)}function n(a){var b,c,d=[];for(var e in a)a.hasOwnProperty(e)&&(b=a[e],c=m(b),d.push(c));return d}function o(){var a,b=0;for(a in this.spritesInfo)this.spritesInfo.hasOwnProperty(a)&&b++;return b}function p(a){return Number(a.replace(/px|%/g,""))}function q(a){return a.replace(/url\(|\"|\)/g,"")}function r(a){var b=a.lastIndexOf("/");return a.substr(b+1)}function s(){this.$el.width(a(window).width()).height(a(window).height())}return c.prototype=Object.create(b.prototype),c.prototype.initOptions=function(a){this.setOptions({visible:!0,opacity:"0.3",color:"#f00",border:"#0f0",image:"",domain:"",callback:null},a)},c.prototype.initStyles=function(a){var b=this._options.image&&""!==this._options.image?'url("'+this._options.image+'")':"none";this.setStyles({main:{position:"relative",display:this._options.visible?"block":"none"},obscurers_container:{position:"relative",display:"block",background:b,top:"0",left:"0","text-align":"left",border:"1px solid "+this._options.border,visibility:this._options.visible?"visible":"hidden"},sprite_obscurer:{position:"absolute",display:"block",background:this._options.color,opacity:this._options.opacity}},a)},c.prototype.filenameFromCss=function(a,b){var c=r(q(a));return b?c.replace(/.png|.jpg|.jpeg|.gif/g,""):c},c.prototype.analyze=function(){f.call(this,i.bind(this))},c.prototype.toggleSprite=function(b){var c,d,e=a("#fibo_sprites_bg");this.$el.hide(),e.show(),a(".obscurers_container").hide(),"hide_sprites"!==b&&(c=b.replace("toggle_sprite_",""),c=c.replace(/[.]/g,"_"),d=a(".obscurers_container#"+c),d.show(),this.$el.show())},c.prototype.logSpritesList=function(){var b=[];this.$el.find(".obscurers_container").each(function(c,d){b.push(a(d).attr("id"))}),console.log(b)},c}(jQuery,UIBaseWidget),images={alpha_pattern:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAA3NCSVQICAjb4U/gAAAACXBIWXMAABX9AAAV/QHNcFFhAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABV0RVh0Q3JlYXRpb24gVGltZQAzMC83LzEzJXLQiAAAACpJREFUKJFj/P//PwM28ODBA6ziTFhF8YBRDcQAFlzhraCgQB0bRjUQAwCn8Qi/9sh3kAAAAABJRU5ErkJggg=="
};